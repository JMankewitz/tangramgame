---
title: "Parents scaffold the formation of conversational pacts"
bibliography: library.bib
csl: apa6.csl
document-params: "10pt, letterpaper"

author-information: > 
    \author{{\large \bf Morton Ann Gernsbacher (MAG@Macc.Wisc.Edu)} \\ Department of Psychology, 1202 W. Johnson Street \\ Madison, WI 53706 USA
    \AND {\large \bf Sharon J.~Derry (SDJ@Macc.Wisc.Edu)} \\ Department of Educational Psychology, 1025 W. Johnson Street \\ Madison, WI 53706 USA}

abstract: >
    Adults readily form pacts, or temporary agreements about referent names, over the course of conversation. Young children do so less reliably with peers, but recent evidence suggests that explicit feedback from adults may improve their performance [@matthews2007]. Might parents naturally provide such structure in their conversations with children? Using a matcher-director paradigm, we first show that parents and children (ages 4, 6, 8) successfully converge increasingly accurate and efficient conversational pacts. Further, parents of younger children provide more interactive feedback. Finally, we analyze asymmetries in parents and children's contributions, finding that pacts tend to originate with the parent, and are simplified by younger children. Together, these results support the idea that parents sensitively adapt their language to their children's developmental level to scaffold successful communication.
    
keywords: >
    referential pacts; parent-child communication
    
output: cogsci2016::cogsci_paper
#final-submission: \cogscifinalcopy
---

```{r global_options, include=FALSE}
knitr::opts_chunk$set(fig.width=3, fig.height=3, fig.crop = F, 
                      fig.pos = "tb", fig.path='figs/',
                      echo=F, warning=F, cache=F, 
                      message=F, sanitize = T)
# Note: to build, 
```

```{r, libraries}
library(broom.mixed)
library(tidyboot)
library(png)
library(grid)
library(xtable)
library(ggthemes)
library(lme4)
library(lmerTest)
library(here)
library(tm)
library(tidytext)
library(directlabels)
library(tidyverse)

theme_set(theme_few(base_size = 12))

CHILD_SCALE <- c("#9ecae1", "#4292c6", "#08519c")
ADULTS <- "black"
PARENTS <- "#fe9929"
```

```{r load-data}
kuperman_aoas <- read_csv(here("corpus_data/kuperman_aoas.csv"))
combined_data <- read_csv(here("deidentified/combined.csv")) 
exchanges_data <- read_csv(here("deidentified/exchanges.csv")) 
```

Common ground is a foundational requirement for successful communication: Interlocutors must both understand each other and know that they understand each other [@clark1986; @bruner1985]. As a consequence, even simple referential expressions are constructed collaboratively. For instance, listeners will often provide a backchannel like "uh huh" to signal their understanding of a speaker's meaning. When the meaning of an utterance is unclear, interlocutors will engage in negotiaton, arriving at a *conversational pact* about how to think and talk about the intended referent [@clark1986]. 

Adults form, revise, and track the formation of pacts fluently. For instance, Brennan and Clark [-@brennan1996] showed that adults will use the right level of specificity for a referent (e.g. "loafer" rather than "shoe" when another shoe is present), carry this forward into a new context with the same conversational partner even when the initial competitor is gone, but revert to "shoe" when a new partner is introduced.

Children, on the other hand, struggle significantly both to establish and to deploy converstational pacts. In a series of studies, Krauss and Glucksberg [-@krauss1969] asked pairs of age-matched children to play a matcher-director game in which success required them to form conversational pacts about novel objects [@glucksberg1966;@krauss1969;@krauss1977]. Across repeated interactions with the same novel objects, @krauss1969 measured two correlated measures of conceptual pact formation: Matcher's accuracy in selecting the correct referent, and reduction of the number of words produced by the director. @krauss1969 found that 5- and 6-year-old children showed very little evidence of success of on either measure, whereas older children both improved accuracy and reduced referential expression lengths over trials. However, even 10- and 11-year-olds were less successful than a comparison group of adults. 

Why do children struggle to form referential pacts? One possibility is that children cannot take their partner's perspective into account, and produce references only they understand [@glucksberg1966]. Alternatively, children may fail to form referential pacts because they are insensitive to informativity in general [@beal1982]. Several studies have shown that children cannot judge which of two references is more informative [@robinson1977; @asher1976]. Finally, the difficulty may partly arise from children's difficulty in the role of matcher: They may struggle to provide sufficient feedback to their partner or ask for clarification when it is necessary [@anderson1994; @garrod1993].

Although children struggled as directors in Krauss and Glucksberg's [-@krauss1977] studies, their performance improved significantly when an adult offered them explicit guidance on whether their referential expressions were ambiguous or otherwise insufficiently informative. In addition, @deutsch1982 showed that clarification questions could be used by adults to eventually elicit unambiguous descriptions from 6- and 9-year-olds and, to a lesser extent, from 3-year-olds. A recent training study by @matthews2007 replicated this finding in 2- to 4-year-olds, and further showed transfer to a different communication task. While these studies show how adult input may help children form informative referential expressions, we do not know whether these kinds of feedback happen in natural adult-child conversations.

```{r ipads, fig.env = "figure*", fig.pos = "!ht", out.width = "500px", fig.align = "center", set.cap.width=T, num.cols.cap=2, fig.cap = "Example of iPad screens for the director (left) and matcher (right) during the game."}
# Note: this is moved up here to get the fig to appear on the right page... i know it's annoying.
knitr::include_graphics("figs/design.pdf")
```

Children engage in conversation with their caregivers from their second year of life [@bruner1985],and their language development is predicted most strongly not by the amount of language they hear, but rather by the amount of conversation they engage in [@romeo2018; @weisleder2013]. Given that young children struggle with informativity and perspective-taking, how do conversations with caregivers succeed? One possiblity is that parents naturally adopt some of the strategies used by experimenters in training studies of conversational pact formation: Pointing out when references are ambiguous, clarifying when children have produced insufficient information, and/or helping children to conceptualize their referential targets in better ways. Indeed, parents' contingent responses to children's incorrect or incomplete utterances have been implicated in children's language learning [@clark1997; @chouinard2003]. 

Parents spend a tremendous amount of time with children, and thus often have quite accurate models of their children's lexical and conceptual knowledge [@fenson2007]. Prior work has shown that parents leverage their knowledge of their children's vocabularies to calibrate the informativeness of their referring expressions [@leung2019]. Do they also leverage this knowledge to scaffold the formation of conversational pacts with children? We asked parents and their 4-, 6-, and 8-year-old children as well as a group of adults to play an adapted version of Krauss and Glucksberg's [-@krauss1969] matcher-director game. We then analyzed their interactions to ask (1) Whether parents' contributions support the formation of conversational pacts, (2) What strategies parents use to support the formation of these pacts, and (3) Whether parents' contributions are tuned to their children's lexical development, changing from 4 to 8 years of age.

# Referential Communication Experiment

```{r acc_exchange_setup, cache = T}
# Note: this is moved up here to get the fig to appear on the right page... i know it's annoying.
d.accuracy.raw <- combined_data %>%
  ungroup() %>%
  mutate(age = as.character(age),
         age = if_else(is.na(age), 'adult', age)) %>%
  mutate(person = ifelse(person %in% c('left', 'right', 'parent'), 
                         'adult', person)) %>%
  group_by(subid, trial, age, target, rep_num) %>%
  summarize(correct = mean(correct)) %>% # make sure each trial is only counted once
  ungroup()

# Bootstrap error bars 
result.acc.means <-  d.accuracy.raw %>%
  group_by(age, rep_num) %>%
  tidyboot_mean(correct)


lmer.accuracy <- d.accuracy.raw %>%
  filter(age != "adult") %>%
  mutate(age = as.numeric(age)) %>%
  glmer(correct ~ age + rep_num + (rep_num | subid) + (1 | target), 
                            family = 'binomial', data = .) %>%
  tidy()

age_effect_acc = lmer.accuracy %>% filter(term == 'age')
rep_effect_acc = lmer.accuracy %>% filter(term == 'rep_num')


d.exchanges.raw <- exchanges_data %>%
  mutate(age = as.character(age)) %>%
  mutate(age = if_else(is.na(age), 'adult', age)) %>%
  group_by(subid, trial, age, target, rep_num) %>%
  summarize(num_exchanges = n()) %>% 
  ungroup()

d.exchanges.mean <- d.exchanges.raw %>%
  group_by(age, rep_num) %>%
  tidyboot_mean(num_exchanges)

# Bootstrap error bars and plot
lmer.exchanges <- d.exchanges.raw %>% 
  filter(age != 'adult') %>%
  mutate(age = as.numeric(age)) %>%
  lmer(num_exchanges ~ age + rep_num +  (rep_num | subid) + (1 | target), 
       control = lmerControl(optimizer = "bobyqa"), data = .) %>%
  tidy()

age_effect_exchanges = lmer.exchanges %>% filter(term == 'age')
rep_effect_exchanges = lmer.exchanges %>% filter(term == 'rep_num')
```

```{r acc_exchanges, cache = T, fig.env = "figure*", fig.pos = "tb", fig.width = 7, fig.height = 2.75, fig.align = "center", set.cap.width=T, num.cols.cap=2, fig.cap = "(A) Accuracy improves over time for all groups. (B) Number of dialogue exchanges is higher for younger children. Error bars are 95\\% CIs. The drop in accuracy for 8-year-olds is likely an artifact of a small set of children losing interest in the task."}

# render plot
plt.results.acc <- result.acc.means %>%   
  ggplot(aes(x = rep_num, y = empirical_stat * 100,  
             group = age, color = age, label = age)) +
  geom_line(position = position_dodge(.25)) +
  geom_errorbar(aes(ymin = ci_lower * 100, ymax = ci_upper * 100),
                width = 0.05, position = position_dodge(.25)) +
  ylab("% accuracy") +
  xlab("repetition #") +
  ylim(78, 100) +
  scale_x_continuous(limits = c(.5, 4.25), breaks = 1:4) + 
  theme(aspect.ratio = 1 / 1.3, legend.position = "none") +
  scale_color_manual(values = c(CHILD_SCALE, ADULTS)) +
  labs(tag = 'A') + 
  geom_dl(method = list(dl.trans(x = x - .2), "first.qp", cex=.8))


# Bootstrap error bars and render plot
plt.results.exchanges <- d.exchanges.mean %>%
  ggplot(aes(x = rep_num, y = empirical_stat, color = age, 
             group = age, label = age)) +
    geom_line(position = position_dodge(.25)) +
    geom_errorbar(aes(ymin = ci_lower, ymax = ci_upper), width = 0,
                  position = position_dodge(.25)) +
    ylab("# exchanges per round") +
    xlab("repetition #") +
    theme(aspect.ratio = 1 / 1.3 , legend.position = "none") +
    scale_color_manual(values = c(CHILD_SCALE, ADULTS)) +
    labs(tag = 'B') +
    scale_x_continuous(limits = c(.75, 4.5), breaks = 1:4) + 
    geom_dl(method = list(dl.trans(x = x + .2), "last.qp", cex=.8)) 

gridExtra::grid.arrange(plt.results.acc, plt.results.exchanges, ncol = 2)
```

### Participants

Children (ages 4, 6, and 8) and their parents were recruited from a database of families in the local community to achieve a planned sample of 60 parent-child pairs. A total of 75 children and their parents participated, but data from 12 pairs were dropped due to experimental error or failure to complete the study, leaving a final sample of 63 pairs. For comparison, adult participants were also recruited from a Psychology Department subject pool to achieve a planned control sample of 20 adult-adult pairs. At the time of analysis, only 15 of these pairs had completed the experiment and had their data transcribed.

### Stimuli 

Twelve solid black images of tangrams were normed on Amazon Mechanical Turk for pairwise similarity. Based on these judgments, the ten maximally dissimilar tangrams were selected for use as stimuli (Fig. \ref{fig:ipads}A). 

### Design and procedure

Pairs of participants were brought into the lab to play a cooperative director-matcher game. They were seated in front of iPads at opposite ends of a table, with a divider preventing them from seeing each other's screens. Participants were told that they would take turns playing *director* and *matcher* roles. The director's task was to describe the *target* image, privately indicated by a blue border, and the matcher's task was to select one of the images on their screen based on the director's description (Fig. \ref{fig:ipads}B). Before beginning the experiment, participants played two practice trials with images of common fruits and vegetables. 

The experiment consisted of four repetition blocks of ten trials each (Fig. \ref{fig:ipads}C). Each tangram was the target once per block. We constructed the trial sequence to ensure that participants both alternated roles from trial to trial and also alternated roles for each *tangram* from block to block. To achieve this structure, we first randomly divided the ten tangrams into two sets of five: the adult was assigned one set to describe on the first block, and the child was assigned the other set. These sets were interleaved on the first block, such that players alternated roles. On each subsequent block, these sets were swapped such that each tangram was described by each participant exactly twice over the course of the experiment. 

On each trial, the target tangram appeared with a foil selected from the set of nine other tangrams.
Targets appeared with different foils on different repetition blocks.
To ensure that the game would not be too difficult for young children, we ensured that the most similar tangrams (based on pairwise similarity norms) did not appear as foils.
To discourage participants from using spatial language (e.g. "the one on the left"), the target and foil were shown in randomized order across the two iPads.
When the matcher selected an image, it became colorful and a pleasant sound played.
Importantly, matchers were not given feedback about the true target, and directors were not given feedback about the matcher's response: the same sound played whether the selection was correct or not.


### Pre-processing

Sessions were videotaped and subsequently transcribed using Datavyu, an open source coding program [@datavyu-team2014]. Each video was transcribed and checked by two different coders. Utterances were manually coded as either part of a trial or unrelated to the game (e.g. parents requesting children to sit down), and unrelated utterances were removed before analysis.

## Results


```{r reduction-setup, cache = TRUE}
d.reduction.raw <- exchanges_data %>%
  mutate(age = ifelse(is.na(age), 'adult', age),
         num_words =  str_count(utterance, " ") +1) %>%
  filter(role == 'director') %>%
  mutate(person = ifelse(person %in% c('left', 'right', 'parent'), 'adult', person)) %>%
  group_by(age, rep_num, person, target, subid, trial) %>%
  summarize(numExchanges = n(),
            num_words = sum(num_words)) %>%
  mutate(normalized_num_words = num_words / numExchanges) %>%
  ungroup() 

d.reduction.means <- d.reduction.raw %>% 
  group_by(age, rep_num, person) %>%
  tidyboot_mean(normalized_num_words) %>%
  mutate(plot_person = case_when(age == "adult" ~ "adult",
                                 person == "adult" ~ "parent",
                                 T ~ age))
```

```{r}
word_exchange_cor = round(cor(d.reduction.raw$numExchanges, d.reduction.raw$num_words),2)

d.reduction.centered <- d.reduction.raw %>% 
  filter(age != 'adult') %>% 
  group_by(subid, person) %>%
  mutate(age = as.numeric(age) - 6,  
         rep_num = as.numeric(rep_num) - 2.5,
         ordinal_rep = if_else(rep_num == first(rep_num), 
                               'first', 'second'))

lmer.reduction.controlled <-  d.reduction.centered %>%  
  lmer(log(normalized_num_words) ~ person * age * rep_num + 
         (1 + rep_num * person | subid) + (1 + rep_num | target), 
       data = ., contrasts = list(person = contr.sum), 
       control = lmerControl('bobyqa')) %>%
  tidy() %>%
  filter(effect == 'fixed')
```

```{r effects}
age_effect_reduction = lmer.reduction.controlled %>% filter(term == 'age')
age_effect_reduction_pvalue <- round(age_effect_reduction$p.value, 3)
age_effect_reduction_pvalue <- ifelse(age_effect_reduction_pvalue < 0.001, 
                               '< 0.001', paste0(c('=', age_effect_reduction_pvalue), collapse = ' '))

rep_effect_reduction = lmer.reduction.controlled %>% filter(term == 'rep_num')
rep_effect_reduction_pvalue <- round(rep_effect_reduction$p.value, 3)
rep_effect_reduction_pvalue <- ifelse(rep_effect_reduction_pvalue < 0.001, 
                               '< 0.001', paste0(c('=', rep_effect_reduction_pvalue), collapse = ' '))

person_effect_reduction = lmer.reduction.controlled %>% filter(term == 'person1')
person_effect_reduction_pvalue <- round(person_effect_reduction$p.value, 3)
person_effect_reduction_pvalue <- ifelse(person_effect_reduction_pvalue < 0.001, 
                               '< 0.001', paste0(c('=', person_effect_reduction_pvalue), collapse = ' '))

person_age_interaction_reduction = lmer.reduction.controlled %>% filter(term == 'person1:age')
person_age_interaction_reduction_pvalue <- round(person_age_interaction_reduction$p.value, 3)
person_age_interaction_reduction_pvalue <- ifelse(person_age_interaction_reduction_pvalue < 0.001, 
                               '< 0.001', paste0(c('=', person_age_interaction_reduction_pvalue), collapse = ' '))

person_rep_interaction_reduction = lmer.reduction.controlled %>% filter(term == 'person1:rep_num')
person_rep_interaction_reduction_pvalue <- round(person_rep_interaction_reduction$p.value, 3)
person_rep_interaction_reduction_pvalue <- ifelse(person_rep_interaction_reduction_pvalue < 0.001, 
                                                  '< 0.001', paste0(c('= ', person_rep_interaction_reduction_pvalue), collapse = ' '))

age_rep_interaction_reduction = lmer.reduction.controlled %>% filter(term == 'age:rep_num')
age_rep_interaction_reduction_pvalue = round(age_rep_interaction_reduction$p.value, 3)
age_rep_interaction_reduction_pvalue <- ifelse(age_rep_interaction_reduction_pvalue < 0.001, 
                                                  '< 0.001', paste0(c('= ', age_rep_interaction_reduction_pvalue), collapse = ' '))

person_age_rep_interaction_reduction = lmer.reduction.controlled %>% filter(term == 'person1:age:rep_num')
person_age_rep_interaction_reduction_pvalue = round(person_age_rep_interaction_reduction$p.value, 3)
person_age_rep_interaction_reduction_pvalue <- ifelse(person_age_rep_interaction_reduction_pvalue < 0.001, 
                                                  '< 0.001', paste0(c('= ', person_age_rep_interaction_reduction_pvalue), collapse = ' '))
```

We characterized developmental differences using three measures of communicative behavior.
First, we examined accuracy to evaluate whether children were able to succeed at the reference game in collaboration with their parents. Second, we examined conversational turn-taking behavior to evaluate how interactive dialogue may contribute to success. Third, we examined the number of words produced by each partner on each turn to evaluate the contributions of children of different ages to the development of efficient pacts.

\todo[inline]{TODO: Specify where and how we use adult-adult data?}

### Performance accuracy

We began by analyzing task performance across age groups.We constructed a mixed-effects logistic regression predicting whether the matcher successfully chose the correct referent on each trial. The model included fixed effects of age and repetition block, random intercepts for each tangram and pair of participants, and random effects of repetition block for each pair of participants. 

Initial accuracy was well above chance for all age groups, indicating that even young children can succeed in this referential task with parents. We also found a significant main effect of age ($b$ = `r round(age_effect_acc$estimate, 2)`, $t$ = `r round(age_effect_acc$statistic, 2)`; $p = 0.003$):  Pairs containing younger children performed significantly worse than pairs containing older children. Critically, however, accuracy improved significantly over the four repetition blocks for all groups ($b$ = `r round(rep_effect_acc$estimate, 2)`, $t$ = `r round(rep_effect_acc$statistic, 2)`, $p < 0.001$; see Fig. \ref{fig:acc_exchanges}A). Such improvement for 4-year-olds contrasts with early results of communication between age-matched children, which found no improvement in accuracy with kindergardeners [age 5, @glucksberg1966;@krauss1969]. 

### Interactive dialogue exchanges

```{r}
questionMarks <- exchanges_data %>% 
  filter(person == 'parent', role == 'matcher') %>% 
  mutate(containQ = str_detect(utterance, "\\?")) %>% 
  rowwise() %>%
  mutate(age = paste0(c('age', age), collapse = "")) %>%
  group_by(age, containQ) %>% 
  tally() %>% 
  group_by(age) %>%
  mutate(proportion = n / sum(n)) %>%
  ungroup()

questionMarkProportions <- questionMarks %>%
  filter(containQ) %>%
  select(age, proportion) %>%
  pivot_wider(names_from = age, values_from = proportion)

chisq.out <- questionMarks %>% 
  select(age, containQ,n) %>%
  spread(containQ,n) %>% 
  select(-age) %>%
  chisq.test() %>%
  tidy()
```

If the ability of children of different ages to successfully establish reference depends on scaffolding provided by their parents, we would expect additional dialogue turns for younger children. We counted the total number of exchanges on each trial, defined as the number of distinct turns of continuous speech. We then constructed a mixed-effects regression predicting the continuous number of exchanges with the same effect structure as reported in the previous section. Consistent with previous work in adults, we found a significant main effect of repetition: Fewer dialogue turns were required on later trials [$b$ = `r round(rep_effect_exchanges$estimate, 2)`, $t$ = `r round(rep_effect_exchanges$statistic, 2)`; $p < 0.001$; @clark1986]. 

In line with our predictions, we also found a significant main effect of age ($b$ = `r round(age_effect_exchanges$estimate, 2)`, $t$ = `r round(age_effect_exchanges$statistic, 2)`; $p < 0.001$). Pairs with 4-year-old children took roughly one additional turn at each point in the experiment than pairs with older children, who more closely resembled pairs of adults (see Fig. \ref{fig:acc_exchanges}B). This increased level of interactivity between parents and younger children provides an interesting contrast with previous studies showing decreased interactivity in pairs of younger children [@garrod1993; @anderson1994].

These lengthier exchanges may reflect efforts by parents to provide and elicit additional clarification or confirmation, or may simply reflect attentional difficulties. As a rough estimate of the content of parents' dialogue responses when their child was the director, we counted the number of question marks in the transcript^[Because questions were not always annotated with a question mark, this represents a lower bound on the true estimate of questions.]. We found `r round(questionMarkProportions$age4, 2) * 100`% of responses to 4-year-olds contained question marks, compared to `r round(questionMarkProportions$age6, 2) * 100`% and `r round(questionMarkProportions$age8, 2) * 100`% to 6 and 8-year-olds, respectively ($\chi^2(2)=$ `r round(chisq.out$statistic,2)
`, $p < 0.001$).

### Reduction in length of referring expression


```{r reduction, cache=T, fig.env = "figure*", fig.pos = "tb", fig.width=7, fig.height=3, fig.align = "center", set.cap.width=T, num.cols.cap=2, fig.cap = "Total number of words in referring expressions produced by children and parents over the course of interaction."}

reduction_labels = tibble(rep_num = c(3.5, 3.5, 2), 
                          empirical_stat = c(14, 6, 10.5), 
                          person = c("parent", "child", "adult"), 
                          plot_person = c("parent", "4", "adult"),
                          age = c("4", "4", "adult"))

d.reduction.means %>%
  ggplot(aes(x = rep_num, y = empirical_stat, 
             group = person, color = plot_person, label = plot_person)) +
  geom_line(position = position_dodge(.25)) +
  facet_grid(. ~ age) + 
  geom_errorbar(aes(ymin = ci_lower, ymax = ci_upper), width = 0,
                position = position_dodge(.25)) +
  geom_text(data = reduction_labels)+
  theme_few() +
  theme(aspect.ratio = 1, legend.position = "none") +
  ylab("# words per exchange") +
  xlab("repetition #") +
  scale_color_manual(values = c(CHILD_SCALE, ADULTS, PARENTS))
```

A key signature of successful communication among adults is an increase in efficiency over repeated reference [@krauss1964;@clark1986]. As pairs form conceptual pacts, they are able to communicate the same meaning using fewer words. We asked whether parents and children of different ages spontaneously reduce their referring expressions in the same way. Because the total number of words produced on a trial is correlated with the number of dialogue exchanges examined above ($r=$ `r word_exchange_cor`), we constructed a normalized efficiency measure that controls for additional turns. Specifically, we defined efficiency as the total number of words produced by the *director* divided by the number of dialogue exchanges on that trial. 

Because participants in a pair alternated roles, each participant served as the director twice for each tangram. This structure allowed us to examine how each participant changed their language when they were the director (Fig. \ref{fig:reduction}). Using a mixed-effects model, we predicted the (log) number of words per exchange on each trial, including fixed effects of child age group, repetition block, and speaker identity (parent vs. child) as well as all of their interactions. We also included random intercepts at the tangram-level and maximal random structure at the dyad level [i.e. intercept, slopes for repetition block and speaker identity, and their interaction; @BarrLevyScheepersTily13_KeepItMaximal]. All variables were centered to allow interpretation of lower-order terms as effects at the average level of the other terms. We found significant main effects of repetition block ($t =$ `r round(rep_effect_reduction$statistic,2)`, $p$`r age_rep_interaction_reduction_pvalue`), speaker identity ($t =$ `r round(person_effect_reduction$statistic,2)`, $p$ `r person_effect_reduction_pvalue`), and age ($t =$ `r round(age_effect_reduction$statistic,2)`, $p$ `r age_effect_reduction_pvalue`). All else being equal, directors use fewer words over subsequent repetitions, children use fewer words than their parents, and pairs with older children use fewer words than pairs with younger children. However, these main effects were clarified by several interactions of interest.

First, while parents on average used more words as director than their children did, we found a significant interaction with the child's age group ($t =$ `r round(person_age_interaction_reduction$statistic,2)`, $p$ `r  person_age_interaction_reduction_pvalue`). This gap between parent and child utterance length is largest at 4 years but nearly disappeared by 8 years. Second, we find that parents reduced their utterance length over time more strongly than children did, holding age group constant ($t =$ `r round(person_rep_interaction_reduction$statistic,2)`, $p$ `r person_rep_interaction_reduction_pvalue`). Third, having older children in a pair supported stronger reduction overall, ($t =$ `r round(age_rep_interaction_reduction$statistic,2)`, $p$ `r age_rep_interaction_reduction_pvalue`). 

Finally, an intriguing developmental question is whether reduction changes over the course of development: are 4-year-olds able to become more efficient as common ground is built in the same way 8-year-olds do? Because parents of different age groups display similar slopes of reduction, this question is addressed by a 3-way interaction. We found that this interaction was not significant ($t=$ `r round(person_age_rep_interaction_reduction$statistic, 2)`, $p$ `r person_age_rep_interaction_reduction_pvalue`), although our sample was likely underpowered to detect this higher-order interaction.

# Analyzing the content of pacts

```{r matches}
matches <- read_csv(here("deidentified/word_matches.csv")) %>% 
  filter(later_rep == 4) %>%
  spread(earlier_rep, match) %>%
  mutate(first_appearance = case_when(`1` ~ '1', 
                                      `2` ~ '2', 
                                      `3` ~ '3', 
                                      TRUE ~ 'never'),
         total = length(first_appearance),
         director = final_round_person,
         matcher = case_when(final_round_person == 'left' ~ 'right',
                             final_round_person == 'right' ~ 'left',
                             final_round_person == 'parent' ~ 'child',
                             final_round_person == 'child' ~ 'parent')) %>%
  filter(first_appearance != 'never') %>%
  mutate(introduced_by = ifelse(first_appearance %in% c('2'), 
                                director, matcher),
         #introduced_by_parent = introduced_by == 'parent',
         introduced_on_first_round = first_appearance %in% c('1'),
         introduced_by_self = introduced_by == director,
         introduced_by_other = introduced_by != director,
          director = ifelse(director %in% c('left', 'right'), 
                            'adult', director),
         age = ifelse(is.na(age), 'adult-adult', age))

mean_matches <- matches %>%
  group_by(age, director) %>%
  tidyboot_mean(introduced_by_other)
```

```{r aoa-computation, cache = TRUE}
tokens <- combined_data %>%
  filter(role == "director") %>%
  group_by(age, person, subid, target, rep_num) %>%
  summarise(words = str_to_lower(utterance)) %>%
  unnest_tokens(word, words) %>%
  ungroup() %>%
  mutate(word = str_to_lower(word))

aoas <- tokens %>%
  left_join(kuperman_aoas, by = "word") %>%
  filter(!word %in% tm::stopwords()) %>%
  group_by(age, person, target, rep_num, subid) %>%
  summarise(aoa = mean(aoa, na.rm = T)) %>%
  group_by(age, person, target, subid) %>%
  ungroup() %>%
  mutate(person = case_when(person == "left" ~ "adult",
                            person == "right" ~ "adult",
                            T ~ person))

mean_aoas <- aoas %>%
  mutate(age = if_else(is.na(age), "adult", as.character(age))) %>%
  group_by(age, person, rep_num, subid) %>%
  summarise(aoa = mean(aoa, na.rm = T)) %>%
  tidyboot_mean(aoa, na.rm = T) %>%
   mutate(plot_person = case_when(person == "adult" ~ "adult",
                                 person == "parent" ~ "parent",
                                 T ~ as.character(age)))

lmer.aoas <- aoas %>%
  filter(!is.na(age)) %>%
  mutate(age = as.numeric(age) - 6, rep_num = rep_num - 2.5) %>%
  lmer(aoa ~ person * age * rep_num + (rep_num * person  | subid) +
         (1 | target), data = ., control = lmerControl(optimizer = "bobyqa")) %>%
  tidy() %>%
  filter(effect == "fixed")
```

```{r origin-effects}
age_effect_origin = lmer.aoas %>% filter(term == 'age')
age_effect_origin_pvalue <- round(age_effect_origin$p.value, 3)
age_effect_origin_pvalue <- ifelse(age_effect_origin_pvalue < 0.001, 
                               '< 0.001', paste0(c('=', age_effect_origin_pvalue),
                                                 collapse = ' '))

rep_effect_origin = lmer.aoas %>% filter(term == 'rep_num')
rep_effect_origin_pvalue <- round(rep_effect_origin$p.value, 3)
rep_effect_origin_pvalue <- ifelse(rep_effect_origin_pvalue < 0.001, 
                               '< 0.001', paste0(c('=', rep_effect_origin_pvalue),
                                                 collapse = ' '))

person_effect_origin = lmer.aoas %>% filter(term == 'personparent')
person_effect_origin_pvalue <- round(person_effect_origin$p.value, 3)
person_effect_origin_pvalue <- ifelse(person_effect_origin_pvalue < 0.001, 
                               '< 0.001', paste0(c('=', person_effect_origin_pvalue), collapse = ' '))

person_age_interaction_origin = lmer.aoas %>% filter(term == 'personparent:age')
person_age_interaction_origin_pvalue <- round(person_age_interaction_origin$p.value, 3)
person_age_interaction_origin_pvalue <- ifelse(person_age_interaction_origin_pvalue < 0.001, 
                               '< 0.001', 
                               paste0(c('=',
                                        person_age_interaction_origin_pvalue), 
                                      collapse = ' '))

person_rep_interaction_origin = lmer.aoas %>% filter(term == 'personparent:rep_num')
person_rep_interaction_origin_pvalue <- round(person_rep_interaction_origin$p.value, 3)
person_rep_interaction_origin_pvalue <- ifelse(person_rep_interaction_origin_pvalue < 0.001, 
                                                  '< 0.001', paste0(c('= ', person_rep_interaction_origin_pvalue), collapse = ' '))

age_rep_interaction_origin = lmer.aoas %>% filter(term == 'age:rep_num')
age_rep_interaction_origin_pvalue = round(age_rep_interaction_origin$p.value, 3)
age_rep_interaction_origin_pvalue <- ifelse(age_rep_interaction_origin_pvalue < 0.001, 
                                                  '< 0.001', paste0(c('= ', age_rep_interaction_origin_pvalue), collapse = ' '))

person_age_rep_interaction_origin = lmer.aoas %>% filter(term == 'personparent:age:rep_num')
person_age_rep_interaction_origin_pvalue = round(person_age_rep_interaction_origin$p.value, 3)
person_age_rep_interaction_origin_pvalue <- ifelse(person_age_rep_interaction_origin_pvalue < 0.001, 
                                                  '< 0.001', paste0(c('= ', person_age_rep_interaction_origin_pvalue), collapse = ' '))
```

```{r origins, cache=T, fig.env = "figure*", fig.pos = "tb", fig.width=7, fig.height=3.5, fig.align = "center", set.cap.width=T, num.cols.cap=2, fig.cap = "(A) Probability of words used on final round first occuring with child or parent. (B) Complexity of language used by different age groups. Error bars are 95\\% CI."}

origins.plt1 <- mean_matches %>%
  #tally() %>%
  ggplot(aes(x = as.numeric(as.factor(age)), y = empirical_stat, 
             group = director, color = director, label = director)) +
    geom_line( position = position_dodge(.25)) +
    geom_point(position = position_dodge(.25)) +
    geom_hline(yintercept = .5, linetype = "dashed") +
    geom_errorbar(aes(ymin = ci_lower, ymax = ci_upper), width = 0,
                  position = position_dodge(.25)) +
    theme(legend.position="top") +
    ylab('% words introduced by partner') +
    scale_x_continuous(name = "age group", limits = c(.25, 4.25),
                       breaks = 1:4, labels = c("4", "6", "8", "adult")) +
    theme(aspect.ratio = 1, legend.position = "none") +
    guides(color=guide_legend(title="Director")) +
    scale_color_manual(values = c(ADULTS, CHILD_SCALE[2], PARENTS)) +
    labs(tag = 'A') +
    geom_dl(method = list(dl.trans(x = x - .15), "first.points", cex=.8))


aoa_labels = tibble(rep_num = c(2, 2, 2), 
                          empirical_stat = c(4.5, 4, 4), 
                          plot_person = c("parent", "4", "adult"),
                          plot_age = c("parent", "child", "adult"),
                          age = c("4", "4", "adult"))

origins.plt2 <- ggplot(mean_aoas, aes(x = rep_num, y = empirical_stat,
                                      color = plot_person)) +
  facet_wrap(~ age, ncol = 2) +
  geom_linerange(aes(ymin = ci_lower, ymax = ci_upper),
                 position = position_dodge(.25)) + 
  geom_line(position = position_dodge(.25)) + 
  theme(aspect.ratio = 1, legend.position = "none") +
  labs(x = "rep #", y = "AoA (average)", tag = "B") +
  scale_color_manual(values = c(CHILD_SCALE, ADULTS, PARENTS)) +
  geom_text(aes(label = plot_age), data = aoa_labels)

cowplot::plot_grid(origins.plt1, origins.plt2, ncol = 2, rel_widths =  c(2/5, 3/5))
```

Pairs of age-matched children are notoriously poor at repeated referential communication, failing to coordinate on mutually comprehensible referring expressions [@glucksberg1966]. Our results demonstrate that when children and their parents solve this coordination problem, converging on increasingly accurate and efficient pacts like pairs of adults. What allows children to coordinate with their parents but not with their peers? 

One possibility is that children lack the ability to *adapt* to their partner: they have a strong preference for a particular idiosyncratic description and are not sensitive to the possibility that their partner may not understand it. Under this hypothesis, children fail with other children because they each continue to use mutually incomprehensible expressions, and only succeed with their parent as a result of the parent's flexibility. Alternatively, young children may be able to adapt successfully but be unable to generate good intial candidate labels. In this case, pairs of children may fail because neither partner can generate an good enough initial label to start the pact-formation process, while children and parents succeed because parents seed the first good candidate label. 

These accounts make different predictions about who is adapting to who: do pacts originate with children, or with adults? We distinguish these accounts by quantitatively analyzing the natural-language transcripts. 

## Where do pacts come from?

```{r match-model, cache = TRUE}
match.model <- matches %>% 
  filter(experiment == 'adult-child') %>% 
  mutate(age = as.numeric(age) - 6) %>%
  glmer(introduced_by_other ~ age * director + (1 | target) +  (1 | subid), 
        contrasts = list(director = contr.sum),
        data = .,
        control=glmerControl('bobyqa'),
        family = 'binomial') %>%
  tidy()

speaker_effect <- match.model %>% filter(term == 'director1')
match.interaction_effect <- match.model %>% filter(term == 'age:director1')
```

For each word in the final description of a tangram, we checked whether it had appeared in an earlier referring expression for that tangram in the same pair. We noted the first trial where it appeared, and who was director when it was produced^[To match different forms of the same word (e.g. "jumping" vs. "jumped") we first lemmatized each word. We also filtered out stop words ("the", "with"), as well as common words that were not part of the pacts ("person", "box"), and excluded words appeared for the first time on the final repetition of each target tangram.]. The proportion of words originating with the child and parent is shown in Fig. \ref{fig:origins}A. We observed an asymmetry: the words used by children on the final repetition were more likely to have originated with their parents than the words used by parents were to originate with their children. In addition, this gap appeared to close with older groups, with parents more likely to adopt words introduced by older children.

We tested this hypothesized interaction using a mixed-effects logistic model predicting whether each word appearing on the final repetition for each tangram was introduced by the current director or by their partner. We included fixed effects of age group and the speaker identity (parent or child), as well as random intercepts for each pair of participants and each tangram. We found a significant main effect of speaker identity, with the words used by children more likely to originate with their partner than the words used by parents, $t=$ `r round(speaker_effect$statistic, 2)`, $p < 0.001$.
Additionally, we found a weak but significant interaction between speaker and age, indicating that this assymetry was smaller for older children ($t=$ `r round(match.interaction_effect$statistic, 2)` $p=$ `r round(match.interaction_effect$p.value,2)`). Thus, parents--especially parents of younger children--appear to be the source of succesful conceptual pacts.

## How do pacts differ across ages?

Given that the labels used by younger children tend to originate with their parents, it is tempting to conclude that adaptation for these pairs is entirely one-sided. However, the resulting pacts may have nonetheless be shaped by children. In particular, we suggest that even though young children may not be able to *supply* good initial labels, they may serve as "regularizers" or "filters" that constrain the complexity of the resulting pact, since it must pass through their comprehension and production system [@hudson-kam2005].

We test this hypothesis by asking about the linguistic complexity of the pacts developed in each agre group. To estimate complexity of each word, we used self-reported age of acquisition estimates. These adult estimates of the relative order in which they acquired over 50,000 words are better predictors of a variety of psycholinguistic processing than other measures of lexical complexity and thus a good candidate measure [@kuperman2012]. For each participant, on each trial, we averaging the estimated age of acquisition for each word in their utterance^[We first removed any words in a list of `r stopwords() %>% length()` stopwords like "at" and "me" from the \texttt{tm} package [@feinerer2008]]. Fig. \ref{fig:origins}B shows the complexity of referring expressions for children and their parents as well as adult-adult pairs over the four repetitions of each target tangram. At all ages, parents produce more linguistically complex referring expressions than children, but as children get older, both their expressions and their parents' become more linguistically complex over repetitions of the same tangram (like adults). 

We confirm this with a mixed-effects model with all possible interactions of age, person (child vs. parent), and repetition number, and maximal random effect structure as before. We found significant main effects of age  ($t =$ `r round(age_effect_origin$statistic,2)`, $p$`r age_effect_origin_pvalue`), and person ($t =$ `r round(person_effect_origin$statistic,2)`, $p$ `r person_effect_origin_pvalue`), but not repetition ($t =$ `r round(rep_effect_origin$statistic,2)`, $p$ `r rep_effect_origin_pvalue`). All else being equal, pairs with older children produce more complex utterances, and so do parents. Further, we found a significant interaction between age and repetition number, suggesting that later repetitions are more complex for dyads with older children ($t =$ `r round(age_rep_interaction_origin$statistic,2)`, $p$ `r  age_rep_interaction_origin_pvalue`). No other effects were significant, indicating that parents utterances remain a constant level of complexity above children's even as children's utterances are becoming more complex. This suggests that the complexity of the pacts that form depend not only on parents, but on children as well--pacts may originate from parents, but children control their complexity.

# Discussion

\todo[inline]{TODO: Merge paragraph 1 and 2. Condense result summary}
Prior work has shown that surprisingly old children struggle to form referential pacts with age-matched peers, but can do so when experimenters explicitly point out when their references are insufficiently informative. Our study shows that even younger children can successfully form referential pacts with their parents in all relevant measures: Accuracy increases, fewer turns are taken, and utterances become shorter. These results suggest that parents may naturally scaffold their children's referential pact formation.

What is the nature of this scaffolding? While all pairs were able to converge on more efficient reference over time, 4-year-olds and their parents took significantly more conversational turns on each trial. Responses to 4-year-olds were more likely to be questions, suggesting that parents could be asking for clarification in those conversational turns. This finding indicates that parents may use some of the strategies seen in training studies [e.g. @matthews2007] when engaging in referential communication with their young children.

Parents also produced longer referring expressions than children overall, suggesting that parents may be providing more information to ensure communicative success. Furthermore, parents of 4-year-olds produced more speech than parents in other age groups. This indicates that parents not only provide more information for their children in general, but that they are sensitive to *how much* information to give based on their children's developmental level.

Finally, we asked *who* initiated the referential pacts, to further understand how parents may be scaffolding communicative success with young children. Communicative success could be explained by two possible accounts: 1) parents would adapt to young children by adopting more of their children's labels; 2) young children, who may not be proficient at generating informative labels, would accept more of their parents' labels. Our analyses show that the labels children use are more likely to have originated from their parents, providing support for the latter account. That is, parent-child pairs are not achieving success due to parents accepting all labels provided by young children. Further, our evidence points to parents offering feedback and perhaps suggesting more informative labels as factors leading to communicative success. While the former account could also lead to communicative success, our results indicate that parents in our sample do not naturally adopt that strategy, and instead opt to scaffold their young children's communicative skills. 

While children eventually become skilled conversationlists, little work has been done to understand *how* they acquire their communicative skills. Our study shows that children as young as four, who fail to reliably form conversational pacts with peers, can do so with a caregiver. Parents appear to naturally scaffold children's conversational pact formation, potentially supporting their communicative development.

# References 

```{r}

# References will be generated automatically by Pandoc and included here.
# The following code is some latex to format the bibliography. Do not remove it.
```

\setlength{\parindent}{-0.1in} 
\setlength{\leftskip}{0.125in}
\noindent
